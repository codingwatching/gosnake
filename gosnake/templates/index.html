<!-- saved from url=(0014)about:internet -->
<!doctype html>
<html lang="ru-RU">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="Cache-Control" content="no-cache"/>
    <title>Go Snake Go</title>
    <meta name="viewport" content="width=device-width, initial-scale=0.5">
    <!-- <meta name="viewport"content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, maximum-scale=1.0"/> -->
    <meta content="/static/img/logo_original.png" itemprop="image">
    <link rel="icon" type="image/png" href="/static/img/logo_original.png" mce_href="/static/img/logo_original.png">
    <link href="/static/img/logo_original.png" rel="shortcut icon">
    <!-- Blackberry and etc. -->
    <meta http-equiv="cleartype" content="on"/>
    <meta name="HandheldFriendly" content="True"/>
    <!-- IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <!--[if IE]>
    <meta http-equiv="imagetoolbar" content="no"/>
    <meta http-equiv="MSThemeCompatible" content="no"/>
    <![endif]-->
    <!-- iPhone -->
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <!-- <link rel="apple-touch-startup-image" href="img/icons/iPhone/startup.png"/> -->
    <link rel="apple-touch-icon" href="/static/img/icons/iPhone/touch-icon-iphone.png"/>
    <link rel="apple-touch-icon" sizes="76x76" href="/static/img/icons/iPhone/touch-icon-ipad.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="/static/img/icons/iPhone/touch-icon-iphone-retina.png"/>
    <link rel="apple-touch-icon" sizes="144x144" href="/static/img/icons/iPhone/touch-icon-ipad-retina.png"/>
    <!-- Windows 8 -->
    <meta name="application-name" content="Snake Game"/>
    <meta name="msapplication-tooltip" content="Slitherio like game"/>
    <meta name="msapplication-window" content="width=400;height=300"/>
    <meta name="msapplication-TileColor" content="#ffffff"/>
    <meta name="msapplication-TileImage" content="/static/img/icons/Win8/custom_icon_144.png"/>
    <meta name="msapplication-square70x70logo" content="/static/img/icons/Win8/custom_icon_70.png"/>
    <meta name="msapplication-square150x150logo" content="/static/img/icons/Win8/custom_icon_150.png"/>
    <meta name="msapplication-square310x310logo" content="/static/img/icons/Win8/custom_icon_310.png"/>
    <meta name="msapplication-wide310x150logo" content="/static/img/icons/Win8/custom_icon_310x150.png"/>
    <!-- Android and etc. -->
    <meta name="format-detection" content="telephone=no"/>
    <meta name="format-detection" content="address=no"/>
    <link rel="stylesheet" type="text/css" href="static/css/style.css?v={{.Version}}">
    <script>
        var game_port = '{{.Port}}';
        var game_server = '{{.Host}}';
        var game_version = '{{.Version}}';
    </script>
    <script src="/static/js/jquery-2.1.4.min.js"></script>
    <script src="/static/js/functions.js?v={{.Version}}"></script>
    <script src="/static/js/pixi.min.js?v={{.Version}}"></script>
    <!-- <script src="/static/js/light.js?v={{.Version}}"></script> -->
    <script src="/static/js/pixi-multistyle-text.js?v={{.Version}}"></script>
    <!-- <script src="/static/js/NormalMapFilter.js?v={{.Version}}"></script> -->

    <script src="/static/js/game.js?v={{.Version}}"></script>
    <script src="/static/js/engine.js?v={{.Version}}"></script>
    <script src="/static/js/test.js?v={{.Version}}"></script>
    <script src="/static/js/connection_properties.js?v={{.Version}}"></script>
    <!-- <script src="http://<?=GAME_SERVER?>:<?=GAME_PORT?>/socket.io/socket.io.js"></script> -->
    <!-- <script src="/static/js/socket.io-1.3.7.js"></script> -->
    <script src="/static/js/client.js?v={{.Version}}"></script>
    <script src="/three/three.min.js?v={{.Version}}"></script>
    <script src="/static/sound/howler.js-master/howler.min.js"></script>
</head>
<body oncontextmenu="return false;">

    <div id="game_canvas"></div>

    <form id="form-login">
        <div>
            <div class="logo">
                <img src="/static/img/logo_web_go.png" alt="Snake" style="height: 109px;">
            </div>
            <input type="hidden" id="input_SkinIndex">
            <div style="text-align: left; padding: 50px; padding-bottom: 20px;">
                <table>
                    <tr>
                        <td style="padding-right: 20px;">
                            <div id="current_skin_preview"></div>
                        </td>
                        <td>
                            <h1>Введите имя</h1>
                            <input id="input_Login" type="text" value="user" style="width: 100%;" autofocus required autocapitalize="off" autocorrect="off" spellcheck="false">
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <a class="btn btn-primary btn-block disabled" id="btn-start" style="cursor: pointer; font-size: 25px; padding: 20px; text-decoration: none" href="#">Начать</a>
                            <div style="margin-top: 20px;">
                                <a class="btn btn-primary" id="btn-enter_to_server" style="cursor: pointer; font-size: 15px; padding: 10px; text-decoration: none" href="#">Присоединиться...</a>
                                <a class="btn btn-primary" id="btn-create_server" style="cursor: pointer; font-size: 15px; padding: 10px; text-decoration: none" href="#">Создать сервер...</a>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
            <div id="create_server" style="display: none;">
                <table>
                    <tr>
                        <th>Размер арены:</th>
                        <td><input id="input_ArenaRadius" type="text" value="20000" style="width: 100%;" autofocus required autocapitalize="off" autocorrect="off" spellcheck="false"></td>
                    </tr>
                    <tr>
                        <th>Стартовая длина игрока:</th>
                        <td><input id="input_StartSnakeSize" type="text" value="100" style="width: 100%;" autofocus required autocapitalize="off" autocorrect="off" spellcheck="false"></td>
                    </tr>
                    <tr>
                        <th>Название сервера:</th>
                        <td><input id="input_ServerName" type="text" value="my_server" style="width: 100%;" autofocus required autocapitalize="off" autocorrect="off" spellcheck="false"></td>
                    </tr>
                    <tr>
                        <th>Множитель количества яблок:</th>
                        <td><input id="input_AppleIntensive" type="number" min="1" max="5" value="1" style="width: 100%;" autofocus required autocapitalize="off" autocorrect="off" spellcheck="false"></td>
                    </tr>
                    <tr>
                        <th>Игрок пропадает при столкновении с другим игроком:</th>
                        <td><input id="input_KillOnCollisionSnakes" type="checkbox" value="1" style="width: 100%;"></td>
                    </tr>
                    <tr>
                        <th>Генерировать яблоки при столкновении игрока со стеной:</th>
                        <td><input id="input_AddApplesOnCollisionWall" type="checkbox" value="1" style="width: 100%;"></td>
                    </tr>
                    <tr>
                        <th></th>
                        <td>
                            <a class="btn btn-primary" id="btn-create_server_apply" style="cursor: pointer; font-size: 15px; padding: 10px; text-decoration: none" href="#">Создать</a>
                        </td>
                    </tr>
                </table>
            </div>
            <div id="skin_list"></div>
            <div class="error" style="margin-top: 15px; color: rgba(255,255,0,.7); height: 40px;"></div>
        </div>
    </form>

    <script>

        try {
            // музыка, звуки
            // *** !!! http://soundimage.org/looping-music/ !!! ***
            var audio = {
                menu: new Howl({urls: ['/static/playlist/menu.mp3'], loop: true}),
                plop: new Howl({urls: ['/static/sound/plop.mp3'], volume: .05}),
                back: new Howl({urls: ['/static/sound/back.mp3'], volume: .5})
            };
        } catch(e) {
            alert(e);
        }

        $(function(){
            // Init engine
            engine.init('game_canvas', 1024, 768);
            game.initTextures();
            $('body').on('keydown', function(e){
                if(e.keyCode == 13) { // Enter
                    if($('#form-login').is(':visible')) {
                        return start();
                    }
                } else if(e.keyCode == 72) { // H
                    console.log('p');
                    if(game.target_hud_alpha == 1) {
                        game.target_hud_alpha = 0;
                    } else {
                        game.target_hud_alpha = 1;
                    }
                } else if(e.keyCode == 45) { // Insert
                    test();
                    // game.pause = !game.pause;
                }
            });

            // механизм смены направления движения
            setInterval(function(){
                game.changeAngle();
            }, 10);

            // обновление статистики
            setInterval(function(){
                // top10 user list
                game.draw.leaderBoard();
                game.updateStat();
            }, 250);

            /*// обновление статистики
            setInterval(function(){
              return;
                var cnt = 0;
                var sz = 0;
                for(id in client.incomming_command_stats) {
                var stat = client.incomming_command_stats[id];
                cnt += stat.count;
                sz += stat.size;
                console.log(stat.name + ' ' + ('.'.repeat(20 - stat.name.length)) +
                ('.'.repeat(9 - new String(stat.count).length)) + ' ' + stat.count + ' | ' +
                (' '.repeat(9 - new String(stat.size).length)) + stat.size + ' bytes');
                }
                if(cnt > 0) {
                    console.log('————————————————————————————————————————————————————————————');
                    console.log('count: ' + cnt + ' | size: ' + sz);
                    console.log('————————————————————————————————————————————————————————————');
                }
            }, 100000000);*/

            // отрисовка очередного кадра
            engine.animate = function(frames, time, fps) {
                var pn = engine.performance_now / 1000;
                if(time > 20) {time = 20;}
                if(game.pause) {return;}
                if(client.logged_id == null) {return;}
                game.objects.restart_button.tick(pn);
                // apples
                game.objects.apples.apple_visible_count = game.objects.apples.tick(pn, time, frames);
                // circular blades
                game.objects.circular_blade.tick(pn);
                // HUD
                game.objects.hud.tick(pn, time);
            }

            engine.draw();
        });

    </script>

</body>
</html>
